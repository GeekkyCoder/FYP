import{r as b,N as Y,x as ee,y as k,D as F,b as ae,ao as ne,j as a,M as se,p as w,ap as te,H as f,aq as ie,K as i,J as le,q as u,L as m,t as g,a9 as y,ar as oe,v as U,w as o,as as ce,z as l,ab as de,E as ue,at as me,W as ge}from"./index-0ada47c2.js";const he={Email:"",Password:""},xe=U().shape({Email:o().email().required(),Password:o().required()}),pe=U().shape({UserName:o().required().min(2).max(30).matches(/^[a-zA-Z]+(\s*[a-zA-Z0-9]*)*$/,"should start with digit and can not include special symbols"),Email:o().email().required(),Password:o().required(),ConfirmPassword:o().oneOf([ce("Password"),null],"Passwords must match").required()}),fe={UserName:"",Email:"",Password:"",ConfirmPassword:""};function je(){const[c,L]=b.useState(null),[d,W]=b.useState("login"),{postRequest:P}=ue(),{uploadImageToCloudinary:T}=me(),[N,j]=b.useState(!1),{setUser:I}=Y(),{alertSeverity:q,handleSnackbarClose:R,snackbarActions:h,snackbarMessage:D,snackbarOpen:A}=ee(),{control:H,handleSubmit:O,formState:{errors:$},reset:z}=k({defaultValues:{...he},resolver:F(xe)}),{control:M,handleSubmit:V,formState:{errors:B},reset:J}=k({defaultValues:{...fe},resolver:F(pe)}),x=ae(),r=ne(),Z=async n=>{const e={email:n.Email,password:n.Password};try{const{user:s}=await P("user/auth/login",e);I(s),localStorage.setItem("user",JSON.stringify(s)),r.push("/"),z(),h("logged in successfully","success",!0)}catch(s){console.log(s),h(s==null?void 0:s.message,"error",!0),console.log(s)}},G=async n=>{j(!0);const e=await T(c),s={userName:n.UserName,email:n==null?void 0:n.Email,password:n==null?void 0:n.Password,confirmPassword:n==null?void 0:n.ConfirmPassword,profilePicture:e};try{await P("user/auth/register",s),J(),j(!1),h("registered successfully","success",!0)}catch(t){h(t==null?void 0:t.message,"error",!0),j(!1),console.log(t)}},v=n=>{W(n)},C=()=>{r.push("/landing-page")},K=n=>{var e;n.preventDefault(),(e=n==null?void 0:n.target)!=null&&e.files[0]&&L(n.target.files[0])},_=({control:n,errors:e,submitHandler:s,handleLogin:t})=>{var p;return a.jsxs(w,{component:"form",onSubmit:s(t),children:[a.jsxs(i,{spacing:3,children:[a.jsx(l,{name:"Email",label:"Email address",control:n,error:!!(e!=null&&e.Email),helperText:e!=null&&e.Email?e==null?void 0:e.Email.message:"",type:"email",fullWidth:!0,icon:"ic:baseline-email"}),a.jsx(l,{control:n,error:!!(e!=null&&e.Password),fullWidth:!0,helperText:e!=null&&e.Password?(p=e==null?void 0:e.Password)==null?void 0:p.message:"",label:"Password",name:"Password",type:"password"})]}),a.jsx(i,{direction:"row",alignItems:"center",justifyContent:"flex-end",sx:{my:3},children:a.jsx(m,{variant:"subtitle2",underline:"hover",children:"Forgot password?"})}),a.jsx(g,{type:"submit",fullWidth:!0,variant:"contained",children:"Login"})]})},Q=({control:n,errors:e,submitHandler:s,handleImageChange:t,handleSignUp:p,isloading:X})=>{var S,E;return a.jsxs(w,{component:"form",onSubmit:s(p),children:[a.jsxs(i,{spacing:3,mb:"1em",children:[a.jsx(l,{name:"UserName",label:"Name",icon:"mdi:account-circle",control:n,error:!!(e!=null&&e.UserName),helperText:e!=null&&e.UserName?e==null?void 0:e.UserName.message:"",type:"text",fullWidth:!0}),a.jsx(l,{name:"Email",label:"Email address",control:n,error:!!(e!=null&&e.Email),helperText:e!=null&&e.Email?e==null?void 0:e.Email.message:"",type:"email",fullWidth:!0,icon:"ic:baseline-email"}),a.jsx(l,{control:n,error:!!(e!=null&&e.Password),fullWidth:!0,helperText:e!=null&&e.Password?(S=e==null?void 0:e.Password)==null?void 0:S.message:"",label:"Password",name:"Password",type:"password"}),a.jsx(l,{control:n,error:!!(e!=null&&e.ConfirmPassword),fullWidth:!0,helperText:e!=null&&e.ConfirmPassword?(E=e==null?void 0:e.ConfirmPassword)==null?void 0:E.message:"",label:"ConfirmPassword",name:"ConfirmPassword",type:"password"}),a.jsxs(i,{direction:"column",children:[a.jsx(u,{component:"div",variant:"p",children:"Profile picture"}),c&&a.jsx(u,{component:"span",variant:"p",children:c==null?void 0:c.name}),a.jsx(de,{accept:"image/*",type:"file",onChange:t})]})]}),a.jsx(g,{loading:X,type:"submit",fullWidth:!0,variant:"contained",children:"Signup"})]})};return a.jsxs(a.Fragment,{children:[a.jsx(se,{alertSeverity:q,handleSnackbarClose:R,snackbarMessage:D,snackbarOpen:A}),a.jsxs(w,{sx:{...te({color:f(x.palette.background.default,.9),imgUrl:"/assets/background/overlay_4.jpg"})},children:[a.jsx(ie,{sx:{position:"fixed",top:{xs:16,md:24},left:{xs:16,md:24}}}),a.jsx(i,{alignItems:"center",justifyContent:"center",sx:{height:1},children:a.jsxs(le,{sx:{p:5,width:1,maxWidth:420},children:[a.jsx(u,{variant:"h4",children:d==="login"?"Signin":"Signup"}),a.jsxs(u,{variant:"body2",sx:{mt:2,mb:5},children:[d==="login"?"Donâ€™t have an account?":"have an account ?",d==="login"?a.jsxs(a.Fragment,{children:[a.jsx(m,{onClick:()=>v("signup"),variant:"subtitle2",sx:{ml:.5},children:"Sign up"}),a.jsx(m,{onClick:C,variant:"subtitle2",sx:{ml:"1em"},children:"Home"})]}):a.jsxs(a.Fragment,{children:[a.jsx(m,{onClick:()=>v("login"),variant:"subtitle2",sx:{ml:.5},children:"Log in"}),a.jsx(m,{onClick:C,variant:"subtitle2",sx:{ml:"1em"},children:"Home"})]})]}),a.jsxs(i,{direction:"row",spacing:2,children:[a.jsx(g,{type:"button",fullWidth:!0,variant:"outlined",sx:{borderColor:f(x.palette.grey[500],.16),color:"inherit"},children:a.jsx(y,{icon:"eva:google-fill",color:"#DF3E30"})}),a.jsx(g,{type:"button",fullWidth:!0,variant:"outlined",sx:{borderColor:f(x.palette.grey[500],.16),color:"inherit"},children:a.jsx(y,{icon:"eva:facebook-fill",color:"#1877F2"})}),a.jsx(g,{fullWidth:!0,variant:"outlined",type:"button",sx:{borderColor:f(x.palette.grey[500],.16),color:"inherit"},children:a.jsx(y,{icon:"eva:twitter-fill",color:"#1C9CEA"})})]}),a.jsx(oe,{sx:{my:3},children:a.jsx(u,{variant:"body2",sx:{color:"text.secondary"},children:"OR"})}),d==="login"&&a.jsx(_,{control:H,errors:$,submitHandler:O,handleLogin:Z}),d==="signup"&&a.jsx(Q,{control:M,errors:B,submitHandler:V,handleImageChange:K,handleSignUp:G,isloading:N})]})})]})]})}function we(){return a.jsxs(a.Fragment,{children:[a.jsx(ge,{children:a.jsx("title",{children:" Phone-Tracker -Login "})}),a.jsx(je,{})]})}export{we as default};
