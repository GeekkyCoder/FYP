import{r as j,x as X,a6 as Y,ad as r,ae as E,t as ee,af as ae,j as a,a7 as ne,B as w,ag as se,n as x,ah as te,S as i,C as ie,ai as u,L as b,aj as m,a as y,D as le,ak as U,al as o,am as oe,an as l,Z as ce,a9 as de,ao as ue,W as me}from"./index-dca286c8.js";const ge={Email:"",Password:""},he=U().shape({Email:o().email().required(),Password:o().required()}),pe=U().shape({UserName:o().required().min(2).max(30).matches(/^[a-zA-Z]+(\s*[a-zA-Z0-9]*)*$/,"should start with digit and can not include special symbols"),Email:o().email().required(),Password:o().required(),ConfirmPassword:o().oneOf([oe("Password"),null],"Passwords must match").required()}),xe={UserName:"",Email:"",Password:"",ConfirmPassword:""};function fe(){const[c,k]=j.useState(null),[d,L]=j.useState("login"),{postRequest:P}=de(),{uploadImageToCloudinary:W}=ue(),[F,f]=j.useState(!1),{setUser:I}=X(),{alertSeverity:N,handleSnackbarClose:T,snackbarActions:g,snackbarMessage:R,snackbarOpen:q}=Y(),{control:D,handleSubmit:A,formState:{errors:O},reset:$}=r({defaultValues:{...ge},resolver:E(he)}),{control:B,handleSubmit:V,formState:{errors:Z},reset:z}=r({defaultValues:{...xe},resolver:E(pe)}),h=ee(),G=ae(),H=async n=>{const e={email:n.Email,password:n.Password};try{const{user:s}=await P("user/auth/login",e);I(s),localStorage.setItem("user",JSON.stringify(s)),G.push("/"),$(),g("logged in successfully","success",!0)}catch(s){console.log(s),g(s==null?void 0:s.message,"error",!0),console.log(s)}},M=async n=>{f(!0);const e=await W(c),s={userName:n.UserName,email:n==null?void 0:n.Email,password:n==null?void 0:n.Password,confirmPassword:n==null?void 0:n.ConfirmPassword,profilePicture:e};try{await P("user/auth/register",s),z(),f(!1),g("registered successfully","success",!0)}catch(t){g(t==null?void 0:t.message,"error",!0),f(!1),console.log(t)}},C=n=>{L(n)},J=n=>{var e;n.preventDefault(),(e=n==null?void 0:n.target)!=null&&e.files[0]&&k(n.target.files[0])},_=({control:n,errors:e,submitHandler:s,handleLogin:t})=>{var p;return a.jsxs(w,{component:"form",onSubmit:s(t),children:[a.jsxs(i,{spacing:3,children:[a.jsx(l,{name:"Email",label:"Email address",control:n,error:!!(e!=null&&e.Email),helperText:e!=null&&e.Email?e==null?void 0:e.Email.message:"",type:"email",fullWidth:!0,icon:"ic:baseline-email"}),a.jsx(l,{control:n,error:!!(e!=null&&e.Password),fullWidth:!0,helperText:e!=null&&e.Password?(p=e==null?void 0:e.Password)==null?void 0:p.message:"",label:"Password",name:"Password",type:"password"})]}),a.jsx(i,{direction:"row",alignItems:"center",justifyContent:"flex-end",sx:{my:3},children:a.jsx(b,{variant:"subtitle2",underline:"hover",children:"Forgot password?"})}),a.jsx(m,{type:"submit",fullWidth:!0,variant:"contained",children:"Login"})]})},K=({control:n,errors:e,submitHandler:s,handleImageChange:t,handleSignUp:p,isloading:Q})=>{var S,v;return a.jsxs(w,{component:"form",onSubmit:s(p),children:[a.jsxs(i,{spacing:3,mb:"1em",children:[a.jsx(l,{name:"UserName",label:"Name",icon:"mdi:account-circle",control:n,error:!!(e!=null&&e.UserName),helperText:e!=null&&e.UserName?e==null?void 0:e.UserName.message:"",type:"text",fullWidth:!0}),a.jsx(l,{name:"Email",label:"Email address",control:n,error:!!(e!=null&&e.Email),helperText:e!=null&&e.Email?e==null?void 0:e.Email.message:"",type:"email",fullWidth:!0,icon:"ic:baseline-email"}),a.jsx(l,{control:n,error:!!(e!=null&&e.Password),fullWidth:!0,helperText:e!=null&&e.Password?(S=e==null?void 0:e.Password)==null?void 0:S.message:"",label:"Password",name:"Password",type:"password"}),a.jsx(l,{control:n,error:!!(e!=null&&e.ConfirmPassword),fullWidth:!0,helperText:e!=null&&e.ConfirmPassword?(v=e==null?void 0:e.ConfirmPassword)==null?void 0:v.message:"",label:"ConfirmPassword",name:"ConfirmPassword",type:"password"}),a.jsxs(i,{direction:"column",children:[a.jsx(u,{component:"div",variant:"p",children:"Profile picture"}),c&&a.jsx(u,{component:"span",variant:"p",children:c==null?void 0:c.name}),a.jsx(ce,{accept:"image/*",type:"file",onChange:t})]})]}),a.jsx(m,{loading:Q,type:"submit",fullWidth:!0,variant:"contained",children:"Signup"})]})};return a.jsxs(a.Fragment,{children:[a.jsx(ne,{alertSeverity:N,handleSnackbarClose:T,snackbarMessage:R,snackbarOpen:q}),a.jsxs(w,{sx:{...se({color:x(h.palette.background.default,.9),imgUrl:"/assets/background/overlay_4.jpg"})},children:[a.jsx(te,{sx:{position:"fixed",top:{xs:16,md:24},left:{xs:16,md:24}}}),a.jsx(i,{alignItems:"center",justifyContent:"center",sx:{height:1},children:a.jsxs(ie,{sx:{p:5,width:1,maxWidth:420},children:[a.jsx(u,{variant:"h4",children:d==="login"?"Signin":"Signup"}),a.jsxs(u,{variant:"body2",sx:{mt:2,mb:5},children:[d==="login"?"Donâ€™t have an account?":"have an account ?",d==="login"?a.jsx(b,{onClick:()=>C("signup"),variant:"subtitle2",sx:{ml:.5},children:"Get Started"}):a.jsx(b,{onClick:()=>C("login"),variant:"subtitle2",sx:{ml:.5},children:"Log in"})]}),a.jsxs(i,{direction:"row",spacing:2,children:[a.jsx(m,{type:"button",fullWidth:!0,variant:"outlined",sx:{borderColor:x(h.palette.grey[500],.16),color:"inherit"},children:a.jsx(y,{icon:"eva:google-fill",color:"#DF3E30"})}),a.jsx(m,{type:"button",fullWidth:!0,variant:"outlined",sx:{borderColor:x(h.palette.grey[500],.16),color:"inherit"},children:a.jsx(y,{icon:"eva:facebook-fill",color:"#1877F2"})}),a.jsx(m,{fullWidth:!0,variant:"outlined",type:"button",sx:{borderColor:x(h.palette.grey[500],.16),color:"inherit"},children:a.jsx(y,{icon:"eva:twitter-fill",color:"#1C9CEA"})})]}),a.jsx(le,{sx:{my:3},children:a.jsx(u,{variant:"body2",sx:{color:"text.secondary"},children:"OR"})}),d==="login"&&a.jsx(_,{control:D,errors:O,submitHandler:A,handleLogin:H}),d==="signup"&&a.jsx(K,{control:B,errors:Z,submitHandler:V,handleImageChange:J,handleSignUp:M,isloading:F})]})})]})]})}function we(){return a.jsxs(a.Fragment,{children:[a.jsx(me,{children:a.jsx("title",{children:" Login "})}),a.jsx(fe,{})]})}export{we as default};
